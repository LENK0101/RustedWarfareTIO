
[core]
name: 盟军战争工厂
price: 0
maxHp: 1200
mass: 30000
radius: 64

#overrideAndReplace: mechFactory, experimentalLandFactory
copyFrom: ROOT:\共享文件\3类\阵营建筑共同.template, ROOT:\共享文件\3类\生产控制.template
tags: 原始护甲, 建筑轻甲, 建筑, 占领, 车厂, 盟军战争工厂, 可入侵, 空下, 非防御建筑, 生产建筑, allied
displayText: Allied War Factory
displayText_zh: 盟军战争工厂
displayDescription: Produce Allied vehicles\nFunds: -2000\nPower: -100
displayDescription_zh: 生产盟军战车\n资金花费：2000\n电力占用：100
borrowResourcesWhileAlive: 电力=100
isBuilding: true
footprint: -3,-1,4,2
constructionFootprint: -3,-1,4,2
buildSpeed: 0
selfBuildRate: 1s
exit_x:40
exit_y:20
exit_dirOffset: 315
exit_moveAwayAmount :100
fogOfWarSightRange: 20
effectOnDeath: CUSTOM:土坑3*2, CUSTOM:土坑2*2, CUSTOM:土坑, CUSTOM:炸毁, CUSTOM:炸毁2, CUSTOM:炸毁3


[graphics]
image:        盟军战争工厂.png
icon_build: ROOT:盟军\单位图标\盟军战争工厂.png

total_frames: 2
imageScale:	0.8
image_offsetX:-8
image_offsetY:-35


[attack]
canAttack: false
canAttackFlyingUnits: false
canAttackLandUnits:   true
canAttackUnderwaterUnits: false


[movement]
movementType: BUILDING


[canBuild_1]
name: setRally, 盟军矿车, 钻油井车

pos: 1
isVisible:if (self.hasUnitInTeam(withTag="盟军矿厂") or self.hasFlag(id=5)) and not self.hasFlag(id=1)
isLocked: if not self.resource(type='入侵计时', empty=true)
isLockedMessage: Be infiltrated! Unlock after 30s.
isLockedMessage_zh: 被入侵，30s后解锁
isLockedAlt2: if not self.resource(type='电力', greaterThan=0) and not self.queueSize(empty=true)
isLockedAlt2Message: Insufficient power for continuous production!
isLockedAlt2Message_zh: 电力不足，不能连续生产


[canBuild_2]
name:  骑士坦克, 步兵战车

pos: 2
isVisible: if not self.hasFlag(id=1) and not self.hasFlag(id=2)
isLocked: if not self.resource(type='入侵计时', empty=true)
isLockedMessage: Be infiltrated! Unlock after 30s.
isLockedMessage_zh: 被入侵，30s后解锁
isLockedAlt2: if not self.resource(type='电力', greaterThan=0) and not self.queueSize(empty=true)
isLockedAlt2Message: Insufficient power for continuous production!
isLockedAlt2Message_zh: 电力不足，不能连续生产


[canBuild_3]
name: 幻影坦克, 坦克杀手

pos: 3
isVisible:if (self.hasUnitInTeam(withTag="盟军机场") or self.hasFlag(id=3)) and not self.hasFlag(id=1)
isLocked: if not self.resource(type='入侵计时', empty=true)
isLockedMessage: Be infiltrated! Unlock after 30s.
isLockedMessage_zh: 被入侵，30s后解锁
isLockedAlt2: if not self.resource(type='电力', greaterThan=0) and not self.queueSize(empty=true)
isLockedAlt2Message: Insufficient power for continuous production!
isLockedAlt2Message_zh: 电力不足，不能连续生产


[canBuild_3-1]
name: 盟军基地车
isVisible:if (self.hasUnitInTeam(withTag="盟军机场") or self.hasFlag(id=3)) and not self.hasFlag(id=1) and not self.globalTeamTags(includes='禁止生产基地车')
@copyFromSection: canBuild_2


[canBuild_4]
name: 光棱坦克, 战斗要塞, 天火坦克

pos: 4
isVisible:if (self.hasUnitInTeam(withTag="科技中心") or self.hasFlag(id=4)) and not self.hasFlag(id=1)
isLocked: if not self.resource(type='入侵计时', empty=true)
isLockedMessage: Be infiltrated! Unlock after 30s.
isLockedMessage_zh: 被入侵，30s后解锁
isLockedAlt2: if not self.resource(type='电力', greaterThan=0) and not self.queueSize(empty=true)
isLockedAlt2Message: Insufficient power for continuous production!
isLockedAlt2Message_zh: 电力不足，不能连续生产


[action_生产飞机]
textAddUnitName: 千里马运输机
descriptionAddFromUnit: 千里马运输机
descriptionAddUnitStats: 千里马运输机
pos: 5
price: 资金=1000
buildSpeed: 10s
displayType: none
unitShownInUI: 千里马运输机
ai_considerSameAsBuilding: 千里马运输机
playAnimationIfNotPlaying: 出厂动画
autoTrigger: if numberOfUnitsInTeam(lessThan=2, withTag='千里马运输机', factoryQueue=true) and self.resource(type='资金', greaterThan=1000) and self.hasUnitInTeam(withTag="盟军机场") and self.isControlledByAI() and self.customTimer(laterThanSeconds=10) and self.resource(type='入侵计时', empty=true) and not self.hasFlag(id=1)
resetCustomTimer: true
spawnUnits: 千里马运输机(offsetX=15, offsetY=-10, offsetDir=135)
isVisible: if (self.hasUnitInTeam(withTag="盟军机场") or self.hasFlag(id=3)) and not self.hasFlag(id=2)
isLocked: if not self.resource(type='入侵计时', empty=true)
isLockedMessage: Be infiltrated! Unlock after 30s.
isLockedMessage_zh: 被入侵，30s后解锁
isLockedAlt2: if not self.resource(type='电力', greaterThan=0) and not self.queueSize(empty=true)
isLockedAlt2Message: Insufficient power for continuous production!
isLockedAlt2Message_zh: 电力不足，不能连续生产


[canBuild_6]
name: 雷神炮艇

pos: 6
isVisible:if ( (self.hasUnitInTeam(withTag="科技中心") and self.hasUnitInTeam(withTag="矿石精炼器") )or self.hasFlag(id=4)) and not self.hasFlag(id=1)
isLocked: if not self.resource(type='入侵计时', empty=true)
isLockedMessage: Be infiltrated! Unlock after 30s.
isLockedMessage_zh: 被入侵，30s后解锁
isLockedAlt2: if self.hasUnitInTeam(withTag="雷神炮艇", factoryQueue=true)
isLockedAlt2Message: Thor Gunship can only have one at a time!
isLockedAlt2Message_zh: 雷神炮艇同时只能有一个
addResources: setFlag=0


[hiddenAction_Ai生产基地车]
autoTrigger: if ((self.noUnitInTeam(withTag='基地') and self.noUnitInTeam(withTag='基地车') and self.resource(type='资金', greaterThan=3000)) or (numberOfUnitsInTeam(withTag='基地车', lessThan=3, factoryQueue=true) and numberOfUnitsInTeam(lessThan=3, withTag='基地') and self.resource(type='资金', greaterThan=20000))) and self.hasUnitInTeam(withTag="盟军机场") and self.isControlledByAI() and self.resource(type='入侵计时', empty=true) and self.customTimer(laterThanSeconds=30) and not self.hasFlag(id=1) and not self.globalTeamTags(includes='禁止生产基地车')
produceUnits: 盟军基地车
resetCustomTimer: true


[hiddenAction_内部人员]
requireConditional: if self.globalTeamTags(includes='盟军')
autoTriggerOnEvent: destroyed
spawnUnits: 防卫大兵*2(offsetRandomX=30, offsetRandomY=30)


[hiddenAction_内部人员2]
requireConditional: if self.globalTeamTags(includes='苏联')
autoTriggerOnEvent: destroyed
spawnUnits: 动员兵*2(offsetRandomX=30, offsetRandomY=30)

[hiddenAction_新创建]
requireConditional: if not self.hasUnitInTeam(withTag = '盟军战争工厂')
setResourcesWithLogic: 新建筑 = 1

[animation_出厂动画]
body_0s: {frame:1}
body_1s: {frame:1}


[effect_电力]
xOffsetRelative: -45
yOffsetRelative: 40


[effect_土坑2]
xOffsetRelativeRandom: 80
yOffsetRelativeRandom: 40


[effect_炸毁]
image: ROOT:\共享文件\1类\炸毁.png
scaleFrom: 3
scaleTo: 3
total_frames: 8
animateFrameStart: 0
animateFrameEnd: 7
animateFrameSpeed: 0.2
xOffsetRelative	:  -45
yOffsetRelative	:  5
xOffsetRelativeRandom:  10
yOffsetRelativeRandom:  5
alwayStartDirAtZero: true
fadeInTime: 0
fadeOut: false
drawUnderUnits:false


[effect_炸毁2]
@copyFromSection: effect_炸毁
xOffsetRelative	:  0
yOffsetRelative	:  -20


[effect_炸毁3]
@copyFromSection: effect_炸毁
xOffsetRelative	:  45
yOffsetRelative	:  -45


[template_zijin]
price: 2000
@global dianli: -100

[template_price]
price: 2000

[ai]
useAsBuilder: true
buildPriority: 0.03
#useAsBuilder: true
noneInBaseExtraPriority:0.3
recommendedInEachBaseNum: 2
recommendedInEachBasePriorityIfUnmet: 0.2